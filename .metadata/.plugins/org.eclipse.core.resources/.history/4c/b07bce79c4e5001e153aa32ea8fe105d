<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>전적 상세 확인</title>
</head>
<body>
    <div>
        <h1>경기 결과</h1>
        <hr>
        <%-- matchInfo 모델에 있는 JSON 데이터를 파싱하여 정보를 뽑아냅니다. --%>
        <% String jsonData = (String) request.getAttribute("tests"); %>
        <% com.google.gson.JsonParser parser = new com.google.gson.JsonParser(); %>
        <% com.google.gson.JsonArray matchInfoArray = parser.parse(jsonData).getAsJsonArray(); %>
        
        <%-- matchInfo 배열에서 각 객체의 정보를 반복하여 출력합니다. --%>
        <% for (com.google.gson.JsonElement matchInfoElement : matchInfoArray) { %>
            <% com.google.gson.JsonObject matchInfoObject = matchInfoElement.getAsJsonObject(); %>
            <%-- 각 객체의 정보를 뽑아냅니다. --%>
            <% String ouid = matchInfoObject.get("ouid").getAsString(); %>
            <% String nickname = matchInfoObject.get("nickname").getAsString(); %>
            <% String matchResult = matchInfoObject.getAsJsonObject("matchDetail").get("matchResult").getAsString(); %>
            <% int possession = matchInfoObject.getAsJsonObject("matchDetail").get("possession").getAsInt(); %>
            <% int shootTotal = matchInfoObject.getAsJsonObject("shoot").get("shootTotal").getAsInt(); %>
            <% int effectiveShootTotal = matchInfoObject.getAsJsonObject("shoot").get("effectiveShootTotal").getAsInt(); %>
            <% int goalTotal = matchInfoObject.getAsJsonObject("shoot").get("goalTotal").getAsInt(); %>
            
            <%-- 뽑아낸 정보를 HTML 형식으로 출력합니다. --%>
            <div>
                <p>유저: <%= nickname %></p>
                <p>경기결과: <%= matchResult %></p>
                <p>점유율: <%= possession %></p>
                <p>총 슈팅수: <%= shootTotal %></p>
                <p>유효 슈팅수: <%= effectiveShootTotal %></p>
                <p>총 골수: <%= goalTotal %></p>
                <hr>
            </div>
        <% } %>
    </div>
</body>
</html>